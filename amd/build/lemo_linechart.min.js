define(["jquery","jqueryui","blocks_lemo4moodle/googlecharts","blocks_lemo4moodle/materialize","blocks_lemo4moodle/lemo_view"],function($,jqui,google,Materialize){function initManage(){function block_lemo4moodle_drawLinechart(){var a=new google.visualization.DataTable;a.addColumn("date",linechartColDate),a.addColumn("number",linechartColAccess),a.addColumn("number",linechartColOwnAccess),a.addColumn("number",linechartColUser),a.addRows(linechartDataArray);var b={chart:{title:linechartTitle},hAxis:{title:linechartColDate,format:"d.M.yy"}},c=new google.visualization.LineChart(document.getElementById("linechart"));c.draw(a,b)}for(var linechartDataArray=JSON.parse($("#linechartDataArray").val()),i=0;i<linechartDataArray.length;i++)linechartDataArray[i][0]=eval(linechartDataArray[i][0]);var linechartDataArrayFilter=JSON.parse($("#linechartDataArrayFilter").val()),linechartColDate=$("#linechartColDate").val(),linechartColAccess=$("#linechartColAccess").val(),linechartColOwnAccess=$("#linechartColOwnAccess").val(),linechartColUser=$("#linechartColUser").val(),linechartTitle=$("#linechartTitle").val(),linechartCheckSelection=$("#linechartCheckSelection").val();$(document).ready(function(){$("#rst_btn_2").click(function(){new google.visualization.DataTable;block_lemo4moodle_drawLinechart(),$("#datepicker_3").val(""),$("#datepicker_4").val("")}),$("#dp_button_2").click(function(){var a=document.getElementById("datepicker_3").value,b=document.getElementById("datepicker_4").value,c=a.split(".");a=c[1]+"/"+c[0]+"/"+c[2];var d=b.split(".");b=d[1]+"/"+d[0]+"/"+d[2],a+=" 00:00:00",b+=" 23:59:59";var e=block_lemo4moodle_toTimestamp(a),f=block_lemo4moodle_toTimestamp(b);if(e<=f){var g=[];linechartDataArrayFilter.forEach(function(a){a.timestamp>=e&&a.timestamp<=f&&g.push({date:a.date,accesses:a.accesses,ownhits:a.ownhits,users:a.user})});var h=g.map(function(a){var b=a.date,c=b.split(", ");return[new Date(c[0],c[1],c[2]),a.accesses,a.ownhits,a.users]}),i=new google.visualization.DataTable;i.addColumn("date",linechartColDate),i.addColumn("number",linechartColAccess),i.addColumn("number",linechartColOwnAccess),i.addColumn("number",linechartColUser),i.addRows(h);var j={chart:{title:linechartTitle},hAxis:{title:linechartColDate,format:"d.M.yy"}},k=new google.visualization.LineChart(document.getElementById("linechart"));k.draw(i,j)}else Materialize.toast(linechartCheckSelection,3e3),$("#datepicker_3").val(""),$("#datepicker_4").val("")}),$("#html_btn_2").click(function(){$("#dialog").dialog("open")}),$(window).resize(function(){block_lemo4moodle_drawLinechart()}),$("#tabs").tabs({onShow:block_lemo4moodle_drawLinechart})})}return{init:function(){initManage()}}});